var context=(function(){var a={INSTANTIATING:{},getFnArgs:function(b){var c=b.$inject||b.prototype.$inject||(window.debug&&b.toString().match(/^function\s*[^\(]*\(\s*([^\)]*)\)/m)[1].split(","))||[];return c[0]===""?[]:c},get:function(e,c,b){var d;c=c.replace(/^\s+|\s+$/g,"");d=e.context.registry[c];if(!d){throw new Error("Unknown dependency: "+c)}if(d.instance){return d.instance}if(!d.type&&d.value instanceof Function===false){d.type="object"}if(d.type==="object"||d.type==="function"){d.instance=d.value;d.type="object";return d.instance}d.type="construtor";d.instance=a.instantiate(e,d.value,b);return d.instance},instantiate:function(f,c,b){var e,d,g;d=function(){};d.prototype=c.prototype;e=new d;g=a.call(f,c,b,e);return g||e},call:function(f,e,b,c){var g,d,i,h;b=b||[];g=Array.prototype.slice.call(b,0);h=g.length;d=a.getFnArgs(e);for(i=h;i<Math.max(d.length,b.length);i++){b[i]!==undefined?g.push(b[i]):g.push(f.get(d[i]))}g.push(f.context);return e.apply(c,g)},createRequest:function(b){return{visited:{},visitedArray:[],context:b,get:function(d,c){this.visitedArray.push(d);if(this.visited[d]===a.INSTANTIATING){throw new Error("Circular reference: "+this.visitedArray.join(" -> "))}this.visited[d]=a.INSTANTIATING;return this.visited[d]=a.get(this,d,c)}}},getRegistryValue:function(c,b){if(!c[b]){throw new Error("Could not instantiate type not found: "+b)}return c[b].value}};return{create:function(){return{registry:{},register:function(c,f,e){var d,b;if(arguments.length===1){d=arguments[0];for(b in d){this.register(b,d[b])}}else{this.registry[c]={value:f,type:e}}},get:function(b,c){var d;if(c===true){return a.getRegistryValue(this.registry,b)}d=a.createRequest(this);return d.get(b)},call:function(d,b,c){var e=a.createRequest(this);return a.call(e,d,b,c)},instantiate:function(c,b){var d,e;if(typeof arguments[0]==="string"){d=arguments[0];c=a.getRegistryValue(this.registry,d)}e=a.createRequest(this);return a.instantiate(e,c,b)}}}}}());context.module=(function(b){var a={modCache:{},globals:{},isArray:Array.isArray||function(c){return Object.prototype.toString.call(c)=="[object Array]"},mixin:function(d,g,c){var e,f=true;for(e in g){if(g.hasOwnProperty(e)){if(c){f=c(e,d[e],g[e])}if(f){d[e]=g[e]}}}return d},handleInject:function(d){var c;if(a.isArray(d)){c=d.pop();c.$inject=d}else{c=d}return c},construct:function(d,c){return function(g,e,h){var j,i,f;if(typeof e!=="function"&&!a.isArray(e)){h=arguments[1];e=function(){}}f=d.instance;e=a.handleInject(e);a.mixin(e.prototype,h);c=a.handleInject(c);j=d.context.call(c,[],f);i=j.apply(f,[e,g]);if(!i){throw new Error("The inner construct function did not return anything.")}f.register(g,i);return i}},mixinRegistries:function(c,d){a.mixin(c,d,function(g,e,f){delete f.instance;if(g==="context"||g==="globals"||c[g]){return false}return true})},foreachUse:function(c,g,d,m){var h=a.modCache[g],j=h.use,e,k,l,f;m=m||{};f=j.length;for(e=0;e<f;e++){k=j[e],l=a.modCache[k];if(!m[k]){if(!l||l.isApp===true){throw new Error("Cannont find module: "+k)}m[k]=true;a.foreachUse(c,j[e],d,m)}}d(h)},mixinAppRegistries:function(c,d){a.foreachUse(c,d,function(e){a.mixinRegistries(c.context.registry,e.context.registry)})},bootstrap:function(c,g){var e,f,d=c.context;a.foreachUse(c,g,function(h){f=h.config.length;for(e=0;e<f;e++){d.call(h.config[e],[],h.instance)}if(h.isApp){f=h.start.length;for(e=0;e<f;e++){d.call(h.start[e],[],h.instance)}}})},createModule:function(e,c){var d={name:e,instance:null,isApp:c,context:b.create(),constructs:{},use:[],config:[],start:[]};d.context.registry._name=e;if(c){d.context.register("context",d.context)}d.context.register("globals",a.globals);d.instance={register:function(){d.context.register.apply(d.context,arguments);return this},construct:function(f,g){d.constructs[f]=d.instance[f]=a.construct(d,g);return this},use:function(j){var g,h,k,f;j=a.isArray(j)?j:Array.prototype.slice.call(arguments,0);f=d.context;for(g=0;g<j.length;g++){h=j[g];d.use.push(h);k=a.modCache[h];if(!k||k.isApp===true){continue}a.mixin(d.constructs,k.constructs,function(m,i,l){if(d.constructs[m]){return false}d.instance[m]=l;return true});a.mixinRegistries(f.registry,k.context.registry)}return this},config:function(f){d.config.push(a.handleInject(f));return this}};if(d.isApp){d.instance.start=function(f){if(arguments.length===0){if(!d.started){a.mixinAppRegistries(d,e);a.bootstrap(d,e)}d.started=true}else{d.start.push(a.handleInject(f))}return this};d.instance.call=function(f){d.context.call(a.handleInject(f))}}d.instance.construct("service",function(){return function(f){return f}});return d}};window.appDebug=function(){console.log(a.modCache)};return function(d){var c,e=a.modCache[d];if(!e){c=arguments[1]?true:false;e=a.createModule(d,c);a.modCache[d]=e}return e.instance}}(context));context.app=(function(){return function(a){return context.module(a,true)}}());